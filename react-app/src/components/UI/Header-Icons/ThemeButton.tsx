import { useContext, useRef, useEffect } from 'react';
import { gsap } from 'gsap';

import ThemeContext from '../../../store/theme-context';
import styles from './ThemeButton.module.css';

const ThemeButton = () => {
  const { theme, changeTheme } = useContext(ThemeContext);
  const svgRef = useRef<SVGSVGElement>(null);

  useEffect(() => {
    const newViewbox = `0 ${theme === 'light' ? '0' : '1000'} 1000 1000`;

    gsap.fromTo(svgRef.current, {
      rotation: '0',
    },{
      duration: 1,
      rotation: '+=360',
      attr: { viewBox: newViewbox },
      transform: `scale(${theme === 'light' ? '1' : '1.3'})`,
      ease: 'power3.inOut',
    });
  }, [theme]);

  const ThemeIcon = () => {
    return (
      <svg
        id={styles['theme-svg']}
        ref={svgRef}
        xmlns='http://www.w3.org/2000/svg'
        viewBox={`0 0 1000 1000`}
      >
        <style>{`.moon-theme{fill:#fffbca} .st11{fill:none}`}</style>
        <circle
          cx={500}
          cy={500}
          r={250}
          style={{
            fill: '#f2a71e',
            stroke: 'none',
          }}
        />
        <path
          d='m802.1 837.5-87-87c-9.2-9.2-9.2-24 0-33.2l2.2-2.2c9.2-9.2 24-9.2 33.2 0l87 87c9.2 9.2 9.2 24 0 33.2l-2.2 2.2c-9.2 9.1-24 9.1-33.2 0zM475 952.3V829.2c0-13 10.5-23.4 23.4-23.4h3.1c13 0 23.4 10.5 23.4 23.4v123.1c0 13-10.5 23.4-23.4 23.4h-3.1c-12.9 0-23.4-10.5-23.4-23.4zM162.5 802.1l87-87c9.2-9.2 24-9.2 33.2 0l2.2 2.2c9.2 9.2 9.2 24 0 33.2l-87 87c-9.2 9.2-24 9.2-33.2 0l-2.2-2.2c-9.1-9.2-9.1-24 0-33.2zM47.7 475h123.1c13 0 23.4 10.5 23.4 23.4v3.1c0 13-10.5 23.4-23.4 23.4H47.7c-13 0-23.4-10.5-23.4-23.4v-3.1c0-12.9 10.5-23.4 23.4-23.4zM197.9 162.5l87 87c9.2 9.2 9.2 24 0 33.2l-2.2 2.2c-9.2 9.2-24 9.2-33.2 0l-87-87c-9.2-9.2-9.2-24 0-33.2l2.2-2.2c9.2-9.1 24-9.1 33.2 0zM525 47.7v123.1c0 13-10.5 23.4-23.4 23.4h-3.1c-13 0-23.4-10.5-23.4-23.4V47.7c0-13 10.5-23.4 23.4-23.4h3.1c12.9 0 23.4 10.5 23.4 23.4zM837.5 197.9l-87 87c-9.2 9.2-24 9.2-33.2 0l-2.2-2.2c-9.2-9.2-9.2-24 0-33.2l87-87c9.2-9.2 24-9.2 33.2 0l2.2 2.2c9.1 9.2 9.1 24 0 33.2zM952.3 525H829.2c-13 0-23.4-10.5-23.4-23.4v-3.1c0-13 10.5-23.4 23.4-23.4h123.1c13 0 23.4 10.5 23.4 23.4v3.1c0 12.9-10.5 23.4-23.4 23.4z'
          style={{
            fill: '#f2a71e',
            stroke: 'none',
          }}
        />
        <path
          d='M688.2 1662.1c-45.8 55.6-115.3 91.1-193 91.1-138.1 0-250-111.9-250-250 0-122.9 88.6-225 205.4-246-35.6 43.2-57 98.6-57 158.9 0 138.1 111.9 250 250 250 15.3 0 30.2-1.4 44.6-4z'
          style={{
            fill: '#fffbca',
          }}
        />
        <path
          className='moon-theme'
          d='M567.8 1334.7h-9.3c0 9.1-7.4 16.5-16.5 16.5v9.3c9.1 0 16.5 7.4 16.5 16.5h9.3c0-9.1 7.4-16.5 16.5-16.5v-9.3c-9.1 0-16.5-7.4-16.5-16.5zm-4.6 27.5c-1.7-2.5-3.9-4.6-6.4-6.4 2.5-1.7 4.6-3.9 6.4-6.4 1.7 2.5 3.9 4.6 6.4 6.4-2.5 1.8-4.7 3.9-6.4 6.4z'
        />
        <path
          className='st11'
          d='M569.5 1355.8c-2.5 1.7-4.6 3.9-6.4 6.4-1.7-2.5-3.9-4.6-6.4-6.4 2.5-1.7 4.6-3.9 6.4-6.4 1.8 2.5 4 4.7 6.4 6.4z'
        />
        <path
          className='moon-theme'
          d='M542 1395.7h-9.3c0 20.7-16.8 37.6-37.6 37.6v9.3c20.7 0 37.6 16.8 37.6 37.6h9.3c0-20.7 16.8-37.6 37.6-37.6v-9.3c-20.7-.1-37.6-16.9-37.6-37.6zm-4.6 64.1c-4.6-9.5-12.4-17.3-21.9-21.9 9.5-4.6 17.3-12.4 21.9-21.9 4.6 9.5 12.3 17.3 21.9 21.9-9.6 4.6-17.3 12.3-21.9 21.9z'
        />
        <path
          className='st11'
          d='M559.3 1437.9c-9.5 4.6-17.3 12.3-21.9 21.9-4.6-9.5-12.4-17.3-21.9-21.9 9.5-4.6 17.3-12.4 21.9-21.9 4.6 9.5 12.3 17.3 21.9 21.9z'
        />
        <path
          className='moon-theme'
          d='M776.4 1334.7h-9.3c0 10.4-8.4 18.8-18.8 18.8v9.3c10.4 0 18.8 8.4 18.8 18.8h9.3c0-10.4 8.4-18.8 18.8-18.8v-9.3c-10.4.1-18.8-8.4-18.8-18.8zm-4.6 31.5c-2.1-3.2-4.8-5.9-8-8 3.2-2.1 5.9-4.8 8-8 2.1 3.2 4.8 5.9 8 8-3.2 2.1-6 4.8-8 8z'
        />
        <circle className='st11' cx={771.8} cy={1358.2} r={8} />
        <path
          className='moon-theme'
          d='M663.9 1358.2h-9.3c0 10.4-8.4 18.8-18.8 18.8v9.3c10.4 0 18.8 8.4 18.8 18.8h9.3c0-10.4 8.4-18.8 18.8-18.8v-9.3c-10.4 0-18.8-8.4-18.8-18.8zm-4.7 31.4c-2.1-3.2-4.8-5.9-8-8 3.2-2.1 5.9-4.8 8-8 2.1 3.2 4.8 5.9 8 8-3.1 2.1-5.9 4.9-8 8z'
        />
        <circle className='st11' cx={659.2} cy={1381.6} r={8} />
        <path
          className='moon-theme'
          d='M523.3 1241H514c0 10.4-8.4 18.8-18.8 18.8v9.3c10.4 0 18.8 8.4 18.8 18.8h9.3c0-10.4 8.4-18.8 18.8-18.8v-9.3c-10.4 0-18.8-8.5-18.8-18.8zm-4.7 31.4c-2.1-3.2-4.8-5.9-8-8 3.2-2.1 5.9-4.8 8-8 2.1 3.2 4.8 5.9 8 8-3.1 2.1-5.9 4.8-8 8z'
        />
        <circle
          transform='rotate(-22.5 518.602 1264.345)'
          className='st11'
          cx={518.6}
          cy={1264.4}
          r={8}
        />
        <path
          className='moon-theme'
          d='M710.8 1236.3h-9.3c0 10.4-8.4 18.8-18.8 18.8v9.3c10.4 0 18.8 8.4 18.8 18.8h9.3c0-10.4 8.4-18.8 18.8-18.8v-9.3c-10.4 0-18.8-8.4-18.8-18.8zm-4.7 31.5c-2.1-3.2-4.8-5.9-8-8 3.2-2.1 5.9-4.8 8-8 2.1 3.2 4.8 5.9 8 8-3.1 2-5.9 4.8-8 8z'
        />
        <circle className='st11' cx={706.1} cy={1259.7} r={8} />
        <path
          className='moon-theme'
          d='M603 1489.4h-9.3c0 10.4-8.4 18.8-18.8 18.8v9.3c10.4 0 18.8 8.4 18.8 18.8h9.3c0-10.4 8.4-18.8 18.8-18.8v-9.3c-10.4 0-18.8-8.4-18.8-18.8zm-4.7 31.5c-2.1-3.2-4.8-5.9-8-8 3.2-2.1 5.9-4.8 8-8 2.1 3.2 4.8 5.9 8 8-3.1 2.1-5.9 4.8-8 8z'
        />
        <circle className='st11' cx={598.3} cy={1512.9} r={8} />
        <path
          className='moon-theme'
          d='M706.1 1405.1h-9.3c0 33.6-27.4 61-61 61v9.3c33.6 0 61 27.4 61 61h9.3c0-33.6 27.4-61 61-61v-9.3c-33.7 0-61-27.4-61-61zm-4.7 106.1c-7.1-18.6-22-33.4-40.5-40.5 18.6-7.1 33.4-22 40.5-40.5 7.1 18.6 22 33.4 40.5 40.5-18.5 7.1-33.3 21.9-40.5 40.5z'
        />
        <path
          className='st11'
          d='M742 1470.7c-18.6 7.1-33.4 21.9-40.5 40.5-7.1-18.6-22-33.4-40.5-40.5 18.6-7.1 33.4-22 40.5-40.5 7.1 18.5 21.9 33.4 40.5 40.5z'
        />
        <path
          className='moon-theme'
          d='M603 1241h-9.3c0 25.9-21.1 46.9-46.9 46.9v9.2c25.9 0 46.9 21.1 46.9 46.9h9.3c0-25.9 21-46.9 46.9-46.9v-9.2c-25.9 0-46.9-21-46.9-46.9zm-4.7 80.8c-5.7-13.1-16.2-23.6-29.2-29.2 13-5.7 23.5-16.2 29.2-29.2 5.7 13 16.2 23.5 29.2 29.2-13 5.6-23.5 16.1-29.2 29.2z'
        />
        <path
          className='st11'
          d='M627.5 1292.6c-13 5.7-23.5 16.2-29.2 29.2-5.7-13.1-16.2-23.6-29.2-29.2 13-5.7 23.5-16.2 29.2-29.2 5.7 13 16.2 23.5 29.2 29.2z'
        />
      </svg>
    );
  };

  const changeThemeHandler = () => {
    if (theme === 'light') {
      changeTheme('dark');
    } else {
      changeTheme('light');
    }
  };

  return (
    <button className={styles['theme-button']} onClick={changeThemeHandler}>
      {ThemeIcon()}
    </button>
  );
};

export default ThemeButton;
